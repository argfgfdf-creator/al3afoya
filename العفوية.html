<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>ğŸ“ Ø§Ù„Ø¹ÙÙˆÙŠØ© ØªØªØµÙ„ Ø¨Ùƒ</title>
<style>
body{
  margin:0;
  font-family: Arial, sans-serif;
  background:#000;
  color:#fff;
  height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
}
.screen{
  width:92%;
  max-width:420px;
  text-align:center;
}
.caller{
  font-size:32px;
  margin-bottom:10px;
}
.sub{
  opacity:.7;
  margin-bottom:25px;
  font-size:18px;
}
.ring{
  font-size:16px;
  opacity:.75;
  margin-bottom:18px;
  animation: blink 1s infinite;
}
@keyframes blink{
  0%{opacity:.2}
  50%{opacity:1}
  100%{opacity:.2}
}
.buttons{
  display:flex;
  gap:14px;
  justify-content:center;
  margin-top:10px;
}
.buttons.hidden{
  display:none;
}
button{
  border:0;
  padding:16px 22px;
  border-radius:16px;
  font-size:18px;
  cursor:pointer;
  min-width:120px;
}
button:active{
  transform: scale(0.95);
}
#reject{ background:#b10000; color:white; }
#answer{ background:#00a000; color:white; }
.msg{
  margin-top:26px;
  font-size:20px;
  min-height:30px;
}
.reset{
  margin-top:20px;
}
.reset button{
  background:#333;
  color:#fff;
  padding:10px 20px;
  font-size:14px;
  min-width:auto;
}
.start-overlay{
  position:fixed;
  top:0;
  left:0;
  width:100%;
  height:100%;
  background:rgba(0,0,0,0.95);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:9999;
}
.start-overlay.hidden{
  display:none;
}
.start-btn{
  background:#00a000;
  color:#fff;
  border:0;
  padding:20px 40px;
  font-size:24px;
  border-radius:16px;
  cursor:pointer;
}
</style>
</head>
<body>
<div class="start-overlay" id="startOverlay">
  <button class="start-btn" id="startBtn">ğŸ”Š Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø±Ù†ÙŠÙ†</button>
</div>

<div class="screen">
  <div class="caller">ğŸ“ Ø§Ù„Ø¹ÙÙˆÙŠØ© ØªØªØµÙ„ Ø¨Ùƒ</div>
  <div class="sub">Ù…ÙƒØ§Ù„Ù…Ø© ÙˆØ§Ø±Ø¯Ø©</div>
  <div id="ringText" class="ring">ğŸ”Š Ø±Ù†ÙŠÙ†...</div>
  <div class="buttons" id="buttonsDiv">
    <button id="reject">Ø±ÙØ¶</button>
    <button id="answer">Ù‚Ø¨ÙˆÙ„</button>
  </div>
  <div id="msg" class="msg"></div>
  <div class="reset">
    <button id="resetBtn">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø©</button>
  </div>
</div>

<audio id="ringAudio" src="1.mp3"></audio>
<audio id="acceptAudio" src="2.mp3"></audio>
<audio id="rejectAudio" src="3.mp3"></audio>

<script>
// ØªØ³Ø¬ÙŠÙ„ Service Worker Ù„Ù„Ø¹Ù…Ù„ Ø¨Ø¯ÙˆÙ† Ø¥Ù†ØªØ±Ù†Øª
if ('serviceWorker' in navigator) {
  const swCode = `
    const CACHE_NAME = 'afawya-v1';
    const urlsToCache = [
      '${location.pathname}',
      '1.mp3',
      '2.mp3',
      '3.mp3'
    ];
    
    self.addEventListener('install', event => {
      event.waitUntil(
        caches.open(CACHE_NAME)
          .then(cache => cache.addAll(urlsToCache))
      );
      self.skipWaiting();
    });
    
    self.addEventListener('activate', event => {
      event.waitUntil(
        caches.keys().then(cacheNames => {
          return Promise.all(
            cacheNames.map(cacheName => {
              if (cacheName !== CACHE_NAME) {
                return caches.delete(cacheName);
              }
            })
          );
        })
      );
      self.clients.claim();
    });
    
    self.addEventListener('fetch', event => {
      event.respondWith(
        caches.match(event.request)
          .then(response => response || fetch(event.request))
          .catch(() => caches.match('${location.pathname}'))
      );
    });
  `;
  
  const blob = new Blob([swCode], { type: 'application/javascript' });
  const swUrl = URL.createObjectURL(blob);
  
  navigator.serviceWorker.register(swUrl)
    .then(() => console.log('âœ… Service Worker Ù…Ø³Ø¬Ù„'))
    .catch(err => console.log('âŒ Ø®Ø·Ø£:', err));
}

const msg = document.getElementById("msg");
const ringText = document.getElementById("ringText");
const answer = document.getElementById("answer");
const reject = document.getElementById("reject");
const buttonsDiv = document.getElementById("buttonsDiv");
const ringAudio = document.getElementById("ringAudio");
const acceptAudio = document.getElementById("acceptAudio");
const rejectAudio = document.getElementById("rejectAudio");
const startOverlay = document.getElementById("startOverlay");
const startBtn = document.getElementById("startBtn");
const resetBtn = document.getElementById("resetBtn");

// ØªØ´ØºÙŠÙ„ Ø§Ù„Ø±Ù†ÙŠÙ† ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ÙˆÙŠØªÙƒØ±Ø± Ù„Ù…Ø§ ÙŠØ®Ù„Øµ
ringAudio.addEventListener('ended', () => {
  ringAudio.currentTime = 0;
  ringAudio.play();
});

// Ø²Ø± Ø§Ù„Ø¨Ø¯Ø¡ - ÙŠØ´ØºÙ„ Ø§Ù„Ø±Ù†ÙŠÙ† ÙˆÙŠØ®ÙÙŠ Ø§Ù„Ù€ overlay
startBtn.onclick = () => {
  ringAudio.play();
  startOverlay.classList.add("hidden");
};

// Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ´ØºÙŠÙ„ Ø§Ù„Ø±Ù†ÙŠÙ† ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
setTimeout(() => {
  ringAudio.play().then(() => {
    startOverlay.classList.add("hidden");
  }).catch(() => {
    // Ø¥Ø°Ø§ ÙØ´Ù„ Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØŒ Ù†ØªØ±Ùƒ Ø²Ø± Ø§Ù„Ø¨Ø¯Ø¡ Ø¸Ø§Ù‡Ø±
  });
}, 100);

// Ø²Ø± Ø§Ù„Ù‚Ø¨ÙˆÙ„
answer.onclick = () => {
  ringAudio.pause();
  ringAudio.currentTime = 0;
  ringText.style.display = "none";
  buttonsDiv.classList.add("hidden");
  acceptAudio.play();
  msg.textContent = "ğŸ˜‚ ØªÙ… Ø§Ù„Ø±Ø¯... Ø§Ù„Ø¹ÙÙˆÙŠØ© Ù‚Ø§Ù„Øª: Ù…Ø±Ø­Ø¨Ø§ Ø¨Ùƒ Ø¨Ø¹Ø§Ù„Ù… Ø§Ù„Ø¹ÙÙˆÙŠØ©!";
};

// Ø²Ø± Ø§Ù„Ø±ÙØ¶
reject.onclick = () => {
  ringAudio.pause();
  ringAudio.currentTime = 0;
  ringText.style.display = "none";
  buttonsDiv.classList.add("hidden");
  rejectAudio.play();
  msg.textContent = "ğŸ˜… ØªÙ… Ø§Ù„Ø±ÙØ¶... Ø§Ù„Ø¹ÙÙˆÙŠØ© Ø²Ø¹Ù„Øª!";
};

// Ø²Ø± Ø§Ù„Ø¥Ø¹Ø§Ø¯Ø© - ÙŠØ±Ø¬Ø¹ ÙƒÙ„ Ø´ÙŠØ¡ Ù„Ù„Ø¨Ø¯Ø§ÙŠØ©
resetBtn.onclick = () => {
  // Ø¥ÙŠÙ‚Ø§Ù ÙƒÙ„ Ø§Ù„Ø£ØµÙˆØ§Øª
  ringAudio.pause();
  acceptAudio.pause();
  rejectAudio.pause();
  
  // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…ÙˆØ§Ø¶Ø¹
  ringAudio.currentTime = 0;
  acceptAudio.currentTime = 0;
  rejectAudio.currentTime = 0;
  
  // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¹Ù†Ø§ØµØ±
  ringText.style.display = "block";
  buttonsDiv.classList.remove("hidden");
  msg.textContent = "";
  
  // ØªØ´ØºÙŠÙ„ Ø§Ù„Ø±Ù†ÙŠÙ† Ù…Ù† Ø¬Ø¯ÙŠØ¯
  ringAudio.play();
};
</script>
</body>

</html>
